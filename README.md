# Выбираем фильм

Библиотека для работы с базой данных фильмов сайта [themoviedb.org](https://themoviedb.org)
Состоит из 6 модулей.

- find_similar.py
- hello_api_TMDB.py
- make_own_db.py
- own_db_helpers.py
- search_in_db.py
- tmdb_helpers.py

Три самостоятельных модуля: find_similar.py, make_own_db.py и search_in_db.py - которые можно запускать отдельно

Три вспомогательных модуля: hello_api_TMDB.py, own_db_helpers.py, tmdb_helpers.py

## Модуль make_own_db.py

Производит загрузку данных по api с сайта [themoviedb.org](https://themoviedb.org).

### Блок if \_\_name__ == '\_\_main__':

Запрашивает ввод api-ключ. Производит пробный запрос к api. Если запрос неудачный, то выводит `Invalid api key`
и закрывает программу. Если удачный, то выводит `please, wait, this operation may take smth like 15-20 minutes` и
загружает до 1000 фильмов. И сохраняет их в локальную базу в виде json-файла.

### load_films:

Принимает api-ключ и максимальное количество загружаемых фильмов (по умолчанию 1000). Производит запросы к api для
каждого фильма по очереди начиная с id 0 и заканчивая 999. Если фильма с таким id нет, то пропускает его. Возвращает
список из загруженных фильмов.

## Модуль find_similar.py

Осуществляет поиск похожих фильмов.

### Блок if \_\_name__ == '\_\_main__':

Запрашивает название файла с базой. Пытается загрузить данные из него. Если данных нет, то выводит сообщение
`File not found, sorry...` и закрывает программу. В противном случае запрашивает у пользователя название фильма.
Производит поиск похожих фильмов по загруженной базе согласно рейтингу похожести. Выводит на основании этого сравнения 8
наиболее похожих фильмов.

### find_my_film:

Принимает искомое название фильма и загруженную базу фильмов. Ищет в базе фильм по названию. Возвращает данные по фильму
либо **None** если не находит.

### get_rating:

Принимает искомы фильм, загруженную базу фильмов и количество ожидаемых рекомендаций (по умолчанию 8). Для каждого
фильма в базе подсчитывает рейтинг похожести по параметрам: принадлежность к коллекции, язык, бюджет и жанр. Возвращает
ожидаемое количество рекомендованных фильмов.

## Модуль search_in_db.py

Осуществляет поиск фильма по загруженной базе.

### Блок if \_\_name__ == '\_\_main__':

Запрашивает название файла с базой. Пытается загрузить данные из него. Если данных нет, то выводит сообщение
`File not found, sorry...` и закрывает программу. В противном случае просит ввести слово и осуществляет его поиск среди
названий фильмов в базе. Выводит все названия фильмов, где было найдено это слово.

### search_for_film:

Принимает искомое слово и загруженную базу фильмов. Осуществляет поиск искомого слова среди названий фильмов в базе.
Возвращает список из названий найденных фильмов.

## Модуль own_db_helpers.py

Вспомогательный модуль. Осуществляет загрузку данных из локальной базы.

### load_data

Принимает путь к файлу. Возвращает **None**, если файла нет. В противном случае загружает данные из него и возвращает
их.

## Модуль hello_api_TMDB.py

Вспомогательный модуль. Производит пробный запрос к api.

### Блок if \_\_name__ == '\_\_main__':

Запрашивает ввод aip-ключа. Производит пробный запрос к api. Если запрос неудачный, то выводит `Invalid api key` и
закрыавет программу. Если удачный, то выводит бюджет фильма "Пила 2".

## Модуль tmdb_helpers.py

Вспомогательный модуль. Содержит функции для работы с api.

### make_tmdb_api_request

Принимает метод запроса, api-ключ, дополнительные параметры (по умолчанию **None**). Формирует ссылку для запроса
и собирает все параметры для него. Возвращает данные в формате json.

### load_json_data_from_url

Принимает ссылку и параметры запроса. Формирует конечный url для запроса, объединяя ссылку с параметрами. 
Производи запрос к api. Возвращает json-данные. 

### get_user_api_key

Ничего не принимает. Запрашивает ввод aip-ключа. Производит пробный запрос к api. Если запрос удачный, то возвращает введенный api-ключ.
В противном случае при ошибке запроса 401 возвращает **None** при других ошибках возбуждает исключение.
